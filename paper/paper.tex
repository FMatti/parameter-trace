\documentclass[hidelinks,onefignum,onetabnum]{siamart250211}

\input{shared}

\ifpdf
\hypersetup{
  pdftitle={Trace estimation for parameter-dependent matrices},
  pdfauthor={F. Matti, H. He, D. Kressner, H. Lam}
}
\fi

\begin{document}
\maketitle

\begin{abstract}
Stochastic trace estimation is a well-established tool for approximating the trace of a large symmetric matrix $\mtx{B}$. Several applications involve a matrix that depends continuously on a parameter $t \in [a,b]$, and require trace estimates of $\mtx{B}(t)$ for many values of $t$. This is, for example, the case when approximating the spectral density of a matrix. Approximating the trace separately for each matrix
$\mtx{B}(t_1), \dots, \mtx{B}(t_m)$ clearly incurs redundancies and a cost that scales linearly with $m$. To address this issue, we propose and analyze modifications for three stochastic trace estimators, the Girard-Hutchinson, Nyström, and Nyström++ estimators. Our modification uses \emph{fixed} randomization across different values of $t$, that is,
every matrix $\mtx{B}(t_1), \dots, \mtx{B}(t_m)$ is multiplied with the \emph{same} set of random vectors.
When combined with Chebyshev approximation in $t$, the use of such constant random matrices allows one to reuse matrix-vector products across different values of $t$, leading to significant cost reduction.
Our analysis shows that the loss of stochastic independence across different $t$ does not lead to deterioration. In particular, we show that $\mathcal{O}(\varepsilon^{-1})$ random matrix-vector products suffice to ensure an error of $\varepsilon > 0$ for Nyström++, independent of low-rank properties of $\mtx{B}(t)$. We discuss in detail how the combination of Nyström++ with 
Chebyshev approximation applies to spectral density estimation and provide an analysis of the resulting method. This  improves various aspects of an existing stochastic estimator for spectral density estimation. Several numerical experiments from electronic structure interaction and neural network optimization validate our findings.
\end{abstract}

\begin{keywords}
trace estimation, low-rank approximation, parameter-dependent matrix, Chebyshev interpolation, spectral density, density of states
\end{keywords}

\begin{MSCcodes}
65C05, 65F15, 65Y20, 68W20, 68W25, 68W40
\end{MSCcodes}

\input{intro.tex}
\input{analysis.tex}
\input{spectraldensity.tex}
\input{numresults.tex}
\input{conclusion.tex}

\input{appendix.tex}

\section*{Acknowledgments}
The authors gratefully acknowledge the help of Lin Lin in reproducing the example in \cref{subsec:hamiltonian}. They thank David Persson for many enlightening discussions relating the proof in \cref{subsec:nystrom-pp}. They would also like to thank the reviewers for their detailed comments, which helped to improve the manuscript.

\bibliographystyle{siamplain}
\bibliography{bibliography}

\clearpage

%\listofchanges[style=list]

\end{document}
